[{"/home/mindbowser/Firebase-Demo/firebase-demo/React-firestore-chat-app/src/index.js":"1","/home/mindbowser/Firebase-Demo/firebase-demo/React-firestore-chat-app/src/App.js":"2","/home/mindbowser/Firebase-Demo/firebase-demo/React-firestore-chat-app/src/pages/Home.js":"3","/home/mindbowser/Firebase-Demo/firebase-demo/React-firestore-chat-app/src/pages/Register.js":"4","/home/mindbowser/Firebase-Demo/firebase-demo/React-firestore-chat-app/src/pages/Login.js":"5","/home/mindbowser/Firebase-Demo/firebase-demo/React-firestore-chat-app/src/components/Navbar.js":"6","/home/mindbowser/Firebase-Demo/firebase-demo/React-firestore-chat-app/src/components/PrivateRoute.js":"7","/home/mindbowser/Firebase-Demo/firebase-demo/React-firestore-chat-app/src/context/auth.js":"8","/home/mindbowser/Firebase-Demo/firebase-demo/React-firestore-chat-app/src/components/User.js":"9","/home/mindbowser/Firebase-Demo/firebase-demo/React-firestore-chat-app/src/components/Message.js":"10","/home/mindbowser/Firebase-Demo/firebase-demo/React-firestore-chat-app/src/firebase.js":"11","/home/mindbowser/Firebase-Demo/firebase-demo/React-firestore-chat-app/src/components/Loading.js":"12","/home/mindbowser/Firebase-Demo/firebase-demo/React-firestore-chat-app/src/components/MessageForm.js":"13","/home/mindbowser/Firebase-Demo/firebase-demo/React-firestore-chat-app/src/components/svg/Attachment.js":"14"},{"size":219,"mtime":1639115310000,"results":"15","hashOfConfig":"16"},{"size":709,"mtime":1663930283317,"results":"17","hashOfConfig":"16"},{"size":3880,"mtime":1639115310000,"results":"18","hashOfConfig":"16"},{"size":2500,"mtime":1639115310000,"results":"19","hashOfConfig":"16"},{"size":2109,"mtime":1664263471663,"results":"20","hashOfConfig":"16"},{"size":1053,"mtime":1663930269010,"results":"21","hashOfConfig":"16"},{"size":445,"mtime":1639115310000,"results":"22","hashOfConfig":"16"},{"size":667,"mtime":1639115310000,"results":"23","hashOfConfig":"16"},{"size":1628,"mtime":1639115310000,"results":"24","hashOfConfig":"16"},{"size":679,"mtime":1639115310000,"results":"25","hashOfConfig":"16"},{"size":779,"mtime":1663930870181,"results":"26","hashOfConfig":"16"},{"size":347,"mtime":1639115310000,"results":"27","hashOfConfig":"16"},{"size":753,"mtime":1639115310000,"results":"28","hashOfConfig":"16"},{"size":612,"mtime":1639115310000,"results":"29","hashOfConfig":"16"},{"filePath":"30","messages":"31","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"32"},"lgtmkv",{"filePath":"33","messages":"34","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"32"},{"filePath":"35","messages":"36","errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"37","usedDeprecatedRules":"32"},{"filePath":"38","messages":"39","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"32"},{"filePath":"40","messages":"41","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"42","messages":"43","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"32"},{"filePath":"44","messages":"45","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"32"},{"filePath":"46","messages":"47","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"32"},{"filePath":"48","messages":"49","errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"50","usedDeprecatedRules":"32"},{"filePath":"51","messages":"52","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"32"},{"filePath":"53","messages":"54","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"32"},{"filePath":"55","messages":"56","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"32"},{"filePath":"57","messages":"58","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"32"},{"filePath":"59","messages":"60","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"32"},"/home/mindbowser/Firebase-Demo/firebase-demo/React-firestore-chat-app/src/index.js",[],["61","62"],"/home/mindbowser/Firebase-Demo/firebase-demo/React-firestore-chat-app/src/App.js",[],"/home/mindbowser/Firebase-Demo/firebase-demo/React-firestore-chat-app/src/pages/Home.js",["63"],"import React, { useEffect, useState } from \"react\";\nimport { db, auth, storage } from \"../firebase\";\nimport {\n  collection,\n  query,\n  where,\n  onSnapshot,\n  addDoc,\n  Timestamp,\n  orderBy,\n  setDoc,\n  doc,\n  getDoc,\n  updateDoc,\n} from \"firebase/firestore\";\nimport { ref, getDownloadURL, uploadBytes } from \"firebase/storage\";\nimport User from \"../components/User\";\nimport MessageForm from \"../components/MessageForm\";\nimport Message from \"../components/Message\";\n\nconst Home = () => {\n  const [users, setUsers] = useState([]);\n  const [chat, setChat] = useState(\"\");\n  const [text, setText] = useState(\"\");\n  const [img, setImg] = useState(\"\");\n  const [msgs, setMsgs] = useState([]);\n\n  const user1 = auth.currentUser.uid;\n\n  useEffect(() => {\n    const usersRef = collection(db, \"users\");\n    // create query object\n    const q = query(usersRef, where(\"uid\", \"not-in\", [user1]));\n    // execute query\n    const unsub = onSnapshot(q, (querySnapshot) => {\n      let users = [];\n      querySnapshot.forEach((doc) => {\n        users.push(doc.data());\n      });\n      setUsers(users);\n    });\n    return () => unsub();\n  }, []);\n\n  const selectUser = async (user) => {\n    setChat(user);\n\n    const user2 = user.uid;\n    const id = user1 > user2 ? `${user1 + user2}` : `${user2 + user1}`;\n\n    const msgsRef = collection(db, \"messages\", id, \"chat\");\n    const q = query(msgsRef, orderBy(\"createdAt\", \"asc\"));\n\n    onSnapshot(q, (querySnapshot) => {\n      let msgs = [];\n      querySnapshot.forEach((doc) => {\n        msgs.push(doc.data());\n      });\n      setMsgs(msgs);\n    });\n\n    // get last message b/w logged in user and selected user\n    const docSnap = await getDoc(doc(db, \"lastMsg\", id));\n    // if last message exists and message is from selected user\n    if (docSnap.data() && docSnap.data().from !== user1) {\n      // update last message doc, set unread to false\n      await updateDoc(doc(db, \"lastMsg\", id), { unread: false });\n    }\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n\n    const user2 = chat.uid;\n\n    const id = user1 > user2 ? `${user1 + user2}` : `${user2 + user1}`;\n\n    let url;\n    if (img) {\n      const imgRef = ref(\n        storage,\n        `images/${new Date().getTime()} - ${img.name}`\n      );\n      const snap = await uploadBytes(imgRef, img);\n      const dlUrl = await getDownloadURL(ref(storage, snap.ref.fullPath));\n      url = dlUrl;\n    }\n\n    await addDoc(collection(db, \"messages\", id, \"chat\"), {\n      text,\n      from: user1,\n      to: user2,\n      createdAt: Timestamp.fromDate(new Date()),\n      media: url || \"\",\n    });\n\n    await setDoc(doc(db, \"lastMsg\", id), {\n      text,\n      from: user1,\n      to: user2,\n      createdAt: Timestamp.fromDate(new Date()),\n      media: url || \"\",\n      unread: true,\n    });\n\n    setText(\"\");\n    setImg(\"\");\n  };\n  return (\n    <div className=\"home_container\">\n      <div className=\"users_container\">\n        {users.map((user) => (\n          <User\n            key={user.uid}\n            user={user}\n            selectUser={selectUser}\n            user1={user1}\n            chat={chat}\n          />\n        ))}\n      </div>\n      <div className=\"messages_container\">\n        {chat ? (\n          <>\n            <div className=\"messages_user\">\n              <h3>{chat.name}</h3>\n            </div>\n            <div className=\"messages\">\n              {msgs.length\n                ? msgs.map((msg, i) => (\n                    <Message key={i} msg={msg} user1={user1} />\n                  ))\n                : null}\n            </div>\n            <MessageForm\n              handleSubmit={handleSubmit}\n              text={text}\n              setText={setText}\n              setImg={setImg}\n            />\n          </>\n        ) : (\n          <h3 className=\"no_conv\">Select a user to start conversation</h3>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default Home;\n","/home/mindbowser/Firebase-Demo/firebase-demo/React-firestore-chat-app/src/pages/Register.js",[],"/home/mindbowser/Firebase-Demo/firebase-demo/React-firestore-chat-app/src/pages/Login.js",[],"/home/mindbowser/Firebase-Demo/firebase-demo/React-firestore-chat-app/src/components/Navbar.js",[],"/home/mindbowser/Firebase-Demo/firebase-demo/React-firestore-chat-app/src/components/PrivateRoute.js",[],"/home/mindbowser/Firebase-Demo/firebase-demo/React-firestore-chat-app/src/context/auth.js",[],"/home/mindbowser/Firebase-Demo/firebase-demo/React-firestore-chat-app/src/components/User.js",["64"],"import React, { useEffect, useState } from \"react\";\nimport Img from \"../image1.jpg\";\nimport { onSnapshot, doc } from \"firebase/firestore\";\nimport { db } from \"../firebase\";\n\nconst User = ({ user1, user, selectUser, chat }) => {\n  const user2 = user?.uid;\n  const [data, setData] = useState(\"\");\n\n  useEffect(() => {\n    const id = user1 > user2 ? `${user1 + user2}` : `${user2 + user1}`;\n    let unsub = onSnapshot(doc(db, \"lastMsg\", id), (doc) => {\n      setData(doc.data());\n    });\n    return () => unsub();\n  }, []);\n\n  return (\n    <>\n      <div\n        className={`user_wrapper ${chat.name === user.name && \"selected_user\"}`}\n        onClick={() => selectUser(user)}\n      >\n        <div className=\"user_info\">\n          <div className=\"user_detail\">\n            <img src={user.avatar || Img} alt=\"avatar\" className=\"avatar\" />\n            <h4>{user.name}</h4>\n            {data?.from !== user1 && data?.unread && (\n              <small className=\"unread\">New</small>\n            )}\n          </div>\n          <div\n            className={`user_status ${user.isOnline ? \"online\" : \"offline\"}`}\n          ></div>\n        </div>\n        {data && (\n          <p className=\"truncate\">\n            <strong>{data.from === user1 ? \"Me:\" : null}</strong>\n            {data.text}\n          </p>\n        )}\n      </div>\n      <div\n        onClick={() => selectUser(user)}\n        className={`sm_container ${chat.name === user.name && \"selected_user\"}`}\n      >\n        <img\n          src={user.avatar || Img}\n          alt=\"avatar\"\n          className=\"avatar sm_screen\"\n        />\n      </div>\n    </>\n  );\n};\n\nexport default User;\n","/home/mindbowser/Firebase-Demo/firebase-demo/React-firestore-chat-app/src/components/Message.js",[],"/home/mindbowser/Firebase-Demo/firebase-demo/React-firestore-chat-app/src/firebase.js",[],"/home/mindbowser/Firebase-Demo/firebase-demo/React-firestore-chat-app/src/components/Loading.js",[],"/home/mindbowser/Firebase-Demo/firebase-demo/React-firestore-chat-app/src/components/MessageForm.js",[],"/home/mindbowser/Firebase-Demo/firebase-demo/React-firestore-chat-app/src/components/svg/Attachment.js",[],{"ruleId":"65","replacedBy":"66"},{"ruleId":"67","replacedBy":"68"},{"ruleId":"69","severity":1,"message":"70","line":43,"column":6,"nodeType":"71","endLine":43,"endColumn":8,"suggestions":"72"},{"ruleId":"69","severity":1,"message":"73","line":16,"column":6,"nodeType":"71","endLine":16,"endColumn":8,"suggestions":"74"},"no-native-reassign",["75"],"no-negated-in-lhs",["76"],"react-hooks/exhaustive-deps","React Hook useEffect has a missing dependency: 'user1'. Either include it or remove the dependency array.","ArrayExpression",["77"],"React Hook useEffect has missing dependencies: 'user1' and 'user2'. Either include them or remove the dependency array.",["78"],"no-global-assign","no-unsafe-negation",{"desc":"79","fix":"80"},{"desc":"81","fix":"82"},"Update the dependencies array to be: [user1]",{"range":"83","text":"84"},"Update the dependencies array to be: [user1, user2]",{"range":"85","text":"86"},[1123,1125],"[user1]",[516,518],"[user1, user2]"]